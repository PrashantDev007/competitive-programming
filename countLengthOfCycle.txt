package gsIncubation;

import java.util.Arrays;
import java.util.Deque;
import java.util.LinkedList;
import java.util.Queue;

public class CountLegthOfCycle {

	public static int countLengthofcycle2(int arr[], int startIndex) {

		if (arr == null || arr.length == 0)
			return -1;

		int slow = arr[startIndex];
		int fast = arr[arr[startIndex]];
		int count = 1;
		if (slow == fast)
			return -1;
		while (slow != fast) {

			if (fast >= arr.length)
				return -1;

			count++;
			slow = arr[slow];
			fast = arr[arr[fast]];
		}
		return count;

	}

	public static int countCycles(int[] data, int start) {
		int[] counters = new int[data.length];
		int index = start;
		int count = 0;
		while (counters[index] == 0) {
			counters[index] = count++;
			index = data[index];
		}
		return count - counters[index];
	}

	public static int countLengthofcycle(int arr[], int startIndex) {
		if (startIndex >= arr.length)
			return -1;
		Deque<Integer> q = new LinkedList<Integer>();

		int j = startIndex;

		int tmp = arr[j];

		while (tmp < arr.length && tmp >= 0) {
			q.addLast(j);

			if (arr[j] == 0)
				arr[j] = -1;
			else
				arr[j] = arr[j] * -1;

			j = tmp;
			tmp = arr[tmp];



		}

		if (tmp >= arr.length)
			return -1;
		else {
			while (!q.isEmpty() && q.peekFirst() != j)
				q.removeFirst();
		}

		// arr[0] no cycle
		if (q.size() == 1)
			return -1;
		return q.size();

	}

	public static void main(String[] args) {
		System.out.println(countLengthofcycle(new int[] { 1, 0 }, 0));
		System.out.println(countLengthofcycle2(new int[] { 1, 4, 3, 2, 3 }, 0));
	}
}
